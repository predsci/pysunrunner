<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pysunrunner.pviz &mdash; pysunrunner 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=2709fde1"></script>
        <script src="../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            pysunrunner
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../guide.html">Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules.html">Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changelog.html">ChangeLog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../license.html">License</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">pysunrunner</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">pysunrunner.pviz</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for pysunrunner.pviz</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<div class="viewcode-block" id="plot_equatorial_cut">
<a class="viewcode-back" href="../../modules/pviz.html#pysunrunner.pviz.plot_equatorial_cut">[docs]</a>
<span class="k">def</span> <span class="nf">plot_equatorial_cut</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">var_name</span> <span class="o">=</span> <span class="s1">&#39;vx1&#39;</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">r_scale</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">log_scale</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> 
    <span class="n">zmin</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">zmax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">conversion_units</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to plot an equatorial cut.</span>

<span class="sd">    **Inputs**:</span>


<span class="sd">    D: PLUTO 3D array of data values</span>

<span class="sd">    var_name: variable to plot</span>

<span class="sd">    cmap: colormap name, default is rainbow</span>

<span class="sd">    title: plot title (optional)</span>

<span class="sd">    r_scale (logical): if True scaled data is plotted (x R^2) (default is False)</span>

<span class="sd">    log_scale (logical): if True log10 of data is plotted (default is False)</span>

<span class="sd">    zmin (scalar): Minimum value for color scaling (optional, if not provided set based on data)</span>

<span class="sd">    zmax (scalar): Maximum value for color scaling (optional, if not provided set based on data)</span>

<span class="sd">    conversion_units (scalar): factor to convert units. (optional, default is no conversion)</span>

<span class="sd">    **Outputs**:</span>

<span class="sd">    ax: subplot with equitorial cut of data</span>

<span class="sd">    **Usage**:</span>

<span class="sd">    ``time_idx = 0``\n</span>

<span class="sd">    ``D = pp.pload(time_idx, w_dir=&#39;./&#39;, datatype=&#39;dbl&#39;)``\n</span>

<span class="sd">    ``var_name = &#39;vx1&#39;``\n</span>

<span class="sd">    ``subplot_kw = {&#39;projection&#39;: &quot;polar&quot;}``\n</span>

<span class="sd">    ``title = &#39;Radial Velocity&#39;``\n</span>

<span class="sd">    </span>
<span class="sd">    ``fig, ax = plt.subplots(subplot_kw=subplot_kw, figsize=(5, 5))``\n</span>

<span class="sd">    ``axs = pviz.plot_equatorial_cut(D=D, var_name=var_name, ax=ax, title=title)``\n</span>
<span class="sd">    </span>
<span class="sd">    ``plt.show()``\n</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">cmap</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;rainbow&#39;</span>
 
    <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">if</span> <span class="n">conversion_units</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">conversion_units</span> <span class="o">=</span> <span class="mf">1.0</span>

    <span class="c1"># the coordinates are D.x1 D.x2 and D.x3 (r, theta, phi)</span>
    <span class="n">r_coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">x1</span><span class="p">)</span>
    <span class="n">t_coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">x2</span><span class="p">)</span>
    <span class="n">p_coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">x3</span><span class="p">)</span>
    
    <span class="c1"># Convert from co-latitude to latitude</span>
    <span class="n">t_coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">t_coords</span>

    <span class="c1"># retrieve the data to be plotted</span>
    <span class="n">data</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">var_name</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">zmin</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">zmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> 
    <span class="k">if</span> <span class="n">zmax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">zmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="c1"># convert units </span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span> <span class="o">*</span> <span class="n">conversion_units</span>
    <span class="n">zmin</span> <span class="o">=</span> <span class="n">zmin</span> <span class="o">*</span> <span class="n">conversion_units</span>
    <span class="n">zmax</span> <span class="o">=</span> <span class="n">zmax</span> <span class="o">*</span> <span class="n">conversion_units</span>

    <span class="c1"># calculate R^2</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">r_scale</span><span class="p">):</span>
        <span class="n">r2_coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">r_coords</span><span class="p">,</span> <span class="n">r_coords</span><span class="p">)</span>

    <span class="c1"># Create a meshgrid for spherical coordinates</span>
    <span class="n">phi_grid</span><span class="p">,</span> <span class="n">r_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">p_coords</span><span class="p">,</span> <span class="n">r_coords</span><span class="p">)</span>

    <span class="c1"># Find the index where theta is closest to 0 (equatorial plane)</span>

    <span class="n">theta_equatorial_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">t_coords</span> <span class="o">-</span> <span class="mi">0</span><span class="p">))</span>

    <span class="n">tmp</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span><span class="n">theta_equatorial_index</span><span class="p">,:]</span>

    <span class="c1"># Transpose</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">T</span>

    <span class="k">if</span> <span class="n">r_scale</span><span class="p">:</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span> <span class="n">r2_coords</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">log_scale</span><span class="p">:</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>    

    <span class="n">Z</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">T</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">phi_grid</span><span class="p">,</span> <span class="n">r_grid</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">shading</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">vmin</span> <span class="o">=</span> <span class="n">zmin</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="n">zmax</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>  <span class="c1"># show R grid</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>  <span class="c1"># Remove angle grid</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">r_coords</span><span class="p">))</span>
    <span class="c1"># ax.set_yticks([]) # remove the R labels  (remove line if we want to keep it)    </span>
    <span class="n">colorbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">shrink</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">aspect</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
   <span class="c1">#colorbar.set_label(cbar_label, fontsize=12)  # To add label for color bar</span>
    <span class="k">return</span> <span class="n">ax</span></div>



<div class="viewcode-block" id="plot_phi_cut">
<a class="viewcode-back" href="../../modules/pviz.html#pysunrunner.pviz.plot_phi_cut">[docs]</a>
<span class="k">def</span> <span class="nf">plot_phi_cut</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">var_name</span> <span class="o">=</span> <span class="s1">&#39;vx1&#39;</span><span class="p">,</span> <span class="n">phi_cut</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">r_scale</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">log_scale</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">zmin</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">zmax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">conversion_units</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to plot a Meridonial cut.</span>

<span class="sd">    **Inputs**:</span>

<span class="sd">    D: PLUTO 3D array of data values.</span>

<span class="sd">    var_name: variable to plot</span>

<span class="sd">    phi_cut: angle in radians for phi_cut, default is meridonial</span>

<span class="sd">    cmap: colormap name, default is rainbow</span>

<span class="sd">    title: plot title (optional)</span>

<span class="sd">    r_scale (logical): if True scaled data is plotted (x R^2) (default is False)</span>

<span class="sd">    log_scale (logical): if True log10 of data is plotted (default is False)</span>

<span class="sd">    zmin (scalar): Minimum value for color scaling (optional, if not provided set based on data)</span>

<span class="sd">    zmax (scalar): Maximum value for color scaling (optional, if not provided set based on data)</span>

<span class="sd">    conversion_units (scalar): factor to convert units. (optional, default is no conversion)</span>

<span class="sd">    **Outputs**:</span>

<span class="sd">    ax: subplot with phi cut of data</span>

<span class="sd">    **Usage**:</span>

<span class="sd">    ``time_idx = 0``\n</span>

<span class="sd">    ``D = pp.pload(time_idx, w_dir=local_dir, datatype=&#39;dbl&#39;)``\n</span>

<span class="sd">    ``var_name = &#39;Bx1&#39;``\n</span>

<span class="sd">    ``phi_cut = np.deg2rad(180.0)``\n</span>

<span class="sd">    ``subplot_kw = {&#39;projection&#39;: &quot;polar&quot;}``\n</span>

<span class="sd">    ``cmap= &#39;coolwarm&#39;``\n</span>

<span class="sd">    ``title = &#39;Scaled Radial Magnetic Field&#39;``\n</span>

<span class="sd">    ``log_scale = False``\n</span>

<span class="sd">    ``r_scale = True``\n</span>

<span class="sd">    ``# convert from code units to nT``\n</span>
<span class="sd">    ``b_fac_pluto = 0.0458505``\n</span>
<span class="sd">    </span>
<span class="sd">    ``fig, ax = plt.subplots(subplot_kw=subplot_kw, figsize=(5, 5))``\n</span>

<span class="sd">    ``ax = pviz.plot_phi_cut(D=D, var_name = var_name, phi_cut = phi_cut, ax = ax,cmap = cmap, title = title, r_scale = r_scale, log_scale=log_scale, conversion_units = b_fac_pluto)``\n</span>
<span class="sd">    ``plt.show()``\n</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">cmap</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;rainbow&#39;</span>

    <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">if</span> <span class="n">conversion_units</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">conversion_units</span> <span class="o">=</span> <span class="mf">1.0</span>


    <span class="c1"># the coordinates are D.x1 D.x2 and D.x3 (r, theta, phi)</span>
    <span class="n">r_coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">x1</span><span class="p">)</span>
    <span class="n">t_coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">x2</span><span class="p">)</span>
    <span class="n">p_coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">x3</span><span class="p">)</span>
    <span class="c1"># Convert from co-latitude to latitude</span>
    <span class="n">t_coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">t_coords</span>

    <span class="c1">#Extract data for plotting</span>

    <span class="n">data</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">var_name</span><span class="p">)</span>

    <span class="c1"># calculate R^2</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">r_scale</span><span class="p">):</span>
        <span class="n">r2_coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">r_coords</span><span class="p">,</span> <span class="n">r_coords</span><span class="p">)</span>

    <span class="c1"># Create a meshgrid for theta and R</span>
    <span class="n">t_grid</span><span class="p">,</span> <span class="n">r_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">t_coords</span><span class="p">,</span> <span class="n">r_coords</span><span class="p">)</span>

    <span class="c1"># Find the index where phi is closest to phi_cut</span>

    <span class="n">phi_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">p_coords</span> <span class="o">-</span> <span class="n">phi_cut</span><span class="p">))</span>

    <span class="n">tmp</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,:,</span><span class="n">phi_index</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">zmin</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">zmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">zmax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">zmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>

    <span class="c1"># convert units </span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">tmp</span> <span class="o">*</span> <span class="n">conversion_units</span>
    <span class="n">zmin</span> <span class="o">=</span> <span class="n">zmin</span> <span class="o">*</span> <span class="n">conversion_units</span>
    <span class="n">zmax</span> <span class="o">=</span> <span class="n">zmax</span> <span class="o">*</span> <span class="n">conversion_units</span>

    <span class="c1"># Transpose</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">T</span>

    <span class="k">if</span> <span class="n">r_scale</span><span class="p">:</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span> <span class="n">r2_coords</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">log_scale</span><span class="p">:</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>    

    <span class="n">Z</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">T</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">t_grid</span><span class="p">,</span> <span class="n">r_grid</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">shading</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">vmin</span> <span class="o">=</span> <span class="n">zmin</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="n">zmax</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_thetalim</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">colorbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">shrink</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">aspect</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span> <span class="n">pad</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">ax</span></div>


<div class="viewcode-block" id="plot_slice">
<a class="viewcode-back" href="../../modules/pviz.html#pysunrunner.pviz.plot_slice">[docs]</a>
<span class="k">def</span> <span class="nf">plot_slice</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">var_name</span> <span class="o">=</span> <span class="s1">&#39;vx1&#39;</span><span class="p">,</span> <span class="n">r_cut</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">theta_cut</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">phi_cut</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">xlabel</span> <span class="o">=</span> <span class="s1">&#39;R (AU)&#39;</span><span class="p">,</span> <span class="n">ylabel</span> <span class="o">=</span> <span class="s1">&#39;V (km s$^{s-1}$)&#39;</span><span class="p">,</span> <span class="n">r_scale</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">log_scale</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">ymin</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">conversion_units</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to plot 1-D slices</span>

<span class="sd">    **Inputs**:</span>

<span class="sd">    D: PLUTO 3D array of data values.</span>

<span class="sd">    var_name: variable name for plotting</span>

<span class="sd">    r_cut: distance in AU for an r-cut, if None data plotted as a function of r</span>

<span class="sd">    theta_cut: latitude angle in radians for a theta-cut, default is equatorial, if None cuts are plotted as a function of theta</span>

<span class="sd">    phi_cut: angle in radians for phi-cut, default is meridonial, if None cuts are plotted as a function of phi</span>

<span class="sd">    cmap: colormap name</span>

<span class="sd">    title: plot title</span>

<span class="sd">    xlabel: x-axis label</span>

<span class="sd">    ylabel: y-axis label</span>

<span class="sd">    r_scale (logical): if True scaled data is plotted (x R^2)</span>

<span class="sd">    log_scale (logical): if True log10 of data is plotted</span>

<span class="sd">    ymin (scalar): Minimum y-axis value for plot</span>

<span class="sd">    ymax (scalar): Maximum y-axis value for plot</span>

<span class="sd">    conversion_units (scalar): factor to convert units.  If None, no conversion</span>

<span class="sd">    **Outputs**:</span>

<span class="sd">    ax: A plot with one or more slices</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">cmap</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;rainbow&#39;</span>

    <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    
    <span class="k">if</span> <span class="n">xlabel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">xlabel</span> <span class="o">=</span> <span class="s1">&#39;x-axis&#39;</span>

    <span class="k">if</span> <span class="n">ylabel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ylabel</span> <span class="o">=</span> <span class="s1">&#39;y-axis&#39;</span>

    <span class="k">if</span> <span class="n">conversion_units</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">conversion_units</span> <span class="o">=</span> <span class="mf">1.0</span>

    <span class="c1"># the coordinates are D.x1 D.x2 and D.x3 (r, theta, phi)</span>
    <span class="n">r_coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">x1</span><span class="p">)</span>
    <span class="n">t_coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">x2</span><span class="p">)</span>
    <span class="n">p_coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">x3</span><span class="p">)</span>

    <span class="c1"># Convert from co-latitude to latitude</span>
    <span class="n">t_coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">t_coords</span>
    
    <span class="c1"># Extract the vx1 data </span>
    <span class="n">data</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">var_name</span><span class="p">)</span>

    <span class="c1"># determine what each dimension of r, t, p is (i.e., what is the x-axis for the plot which dimension)    </span>
    <span class="k">if</span> <span class="n">r_cut</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">theta_cut</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">theta_cut</span><span class="p">)</span>
        <span class="n">phi_cut</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">phi_cut</span><span class="p">)</span>
        <span class="n">theta_cut</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">theta_cut</span><span class="p">)</span>
        <span class="n">phi_cut</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">phi_cut</span><span class="p">)</span>
        <span class="n">slice_dim</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">theta_cut</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">theta_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">t_coords</span> <span class="o">-</span> <span class="n">theta_cut</span><span class="p">))</span>
            <span class="n">data_2d</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span><span class="n">theta_index</span><span class="p">,:]</span>
            <span class="n">slice_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">p_coords</span> <span class="o">-</span> <span class="n">phi</span><span class="p">))</span> <span class="k">for</span> <span class="n">phi</span> <span class="ow">in</span> <span class="n">phi_cut</span><span class="p">])</span>
            <span class="n">slice_val</span> <span class="o">=</span> <span class="n">p_coords</span><span class="p">[</span><span class="n">slice_index</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">phi_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">p_coords</span> <span class="o">-</span> <span class="n">phi_cut</span><span class="p">))</span>
            <span class="n">data_2d</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,:,</span><span class="n">phi_index</span><span class="p">]</span>
            <span class="n">slice_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">t_coords</span> <span class="o">-</span> <span class="n">theta</span><span class="p">))</span> <span class="k">for</span> <span class="n">theta</span> <span class="ow">in</span> <span class="n">theta_cut</span><span class="p">])</span>
            <span class="n">slice_val</span> <span class="o">=</span> <span class="n">t_coords</span><span class="p">[</span><span class="n">slice_index</span><span class="p">]</span>

        <span class="n">label</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">rad2deg</span><span class="p">(</span><span class="n">slice_val</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">r_coords</span>

    <span class="k">if</span> <span class="n">theta_cut</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">r_cut</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">r_cut</span><span class="p">)</span>
        <span class="n">phi_cut</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">phi_cut</span><span class="p">)</span>
        <span class="n">r_cut</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">r_cut</span><span class="p">)</span>
        <span class="n">phi_cut</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">phi_cut</span><span class="p">)</span>   
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">r_cut</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">r_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">r_coords</span> <span class="o">-</span> <span class="n">r_cut</span><span class="p">))</span>
            <span class="n">data_2d</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">r_index</span><span class="p">,:,:]</span>
            <span class="n">slice_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">p_coords</span> <span class="o">-</span> <span class="n">phi</span><span class="p">))</span> <span class="k">for</span> <span class="n">phi</span> <span class="ow">in</span> <span class="n">phi_cut</span><span class="p">])</span>
            <span class="n">slice_dim</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">slice_val</span> <span class="o">=</span> <span class="n">p_coords</span><span class="p">[</span><span class="n">slice_index</span><span class="p">]</span>
            <span class="n">label</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">rad2deg</span><span class="p">(</span><span class="n">slice_val</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">phi_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">p_coords</span> <span class="o">-</span> <span class="n">phi_cut</span><span class="p">))</span>
            <span class="n">data_2d</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,:,</span><span class="n">phi_index</span><span class="p">]</span>
            <span class="n">slice_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">r_coords</span> <span class="o">-</span> <span class="n">r</span><span class="p">))</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">r_cut</span><span class="p">])</span>
            <span class="n">slice_dim</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">slice_val</span> <span class="o">=</span> <span class="n">r_coords</span><span class="p">[</span><span class="n">slice_index</span><span class="p">]</span>
            <span class="n">label</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">slice_val</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

        <span class="n">x</span> <span class="o">=</span> <span class="n">t_coords</span>

    <span class="k">if</span> <span class="n">phi_cut</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">r_cut</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">r_cut</span><span class="p">)</span>
        <span class="n">theta_cut</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">theta_cut</span><span class="p">)</span>
        <span class="n">r_cut</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">r_cut</span><span class="p">)</span>
        <span class="n">theta_cut</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_1d</span><span class="p">(</span><span class="n">theta_cut</span><span class="p">)</span>
        <span class="n">slice_dim</span> <span class="o">=</span> <span class="mi">0</span>    
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">r_cut</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">r_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">r_coords</span> <span class="o">-</span> <span class="n">r_cut</span><span class="p">))</span>
            <span class="n">data_2d</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">r_index</span><span class="p">,:,:]</span>
            <span class="n">slice_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">t_coords</span> <span class="o">-</span> <span class="n">theta</span><span class="p">))</span> <span class="k">for</span> <span class="n">theta</span> <span class="ow">in</span> <span class="n">theta_cut</span><span class="p">])</span>
            <span class="n">slice_val</span> <span class="o">=</span> <span class="n">t_coords</span><span class="p">[</span><span class="n">slice_index</span><span class="p">]</span>
            <span class="n">label</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">rad2deg</span><span class="p">(</span><span class="n">slice_val</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">theta_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">t_coords</span> <span class="o">-</span> <span class="n">theta_cut</span><span class="p">))</span>
            <span class="n">data_2d</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span><span class="n">theta_index</span><span class="p">,:]</span>
            <span class="n">slice_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">r_coords</span> <span class="o">-</span> <span class="n">r</span><span class="p">))</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">r_cut</span><span class="p">])</span>
            <span class="n">slice_val</span> <span class="o">=</span> <span class="n">r_coords</span><span class="p">[</span><span class="n">slice_index</span><span class="p">]</span>
            <span class="n">label</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">slice_val</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

        <span class="n">x</span> <span class="o">=</span> <span class="n">p_coords</span>


    <span class="k">if</span> <span class="n">ymin</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ymin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">data_2d</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ymax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ymax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">data_2d</span><span class="p">)</span>

   <span class="c1"># convert units</span>
    <span class="n">data_2d</span> <span class="o">=</span> <span class="n">data_2d</span> <span class="o">*</span> <span class="n">conversion_units</span>
    <span class="n">ymin</span> <span class="o">=</span> <span class="n">ymin</span> <span class="o">*</span> <span class="n">conversion_units</span>
    <span class="n">ymax</span> <span class="o">=</span> <span class="n">ymax</span> <span class="o">*</span> <span class="n">conversion_units</span>

    <span class="n">n_slice</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">slice_index</span><span class="p">)</span>
    <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n_slice</span><span class="p">)</span>
    <span class="c1"># cmap = plt.colormaps[cmap]</span>
    <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">cmap</span><span class="p">)</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="n">cmap</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span>

 
    <span class="c1"># calculate R^2</span>
    <span class="k">if</span> <span class="n">r_scale</span><span class="p">:</span>
        <span class="n">r2_coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">r_coords</span><span class="p">,</span> <span class="n">r_coords</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">log_scale</span><span class="p">:</span>
        <span class="n">data_2d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">data_2d</span><span class="p">)</span>

    <span class="n">jcount</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">slice_dim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">islice</span> <span class="ow">in</span> <span class="n">slice_index</span><span class="p">:</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">data_2d</span><span class="p">[:,</span><span class="n">islice</span><span class="p">]</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="n">jcount</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="n">label</span><span class="p">[</span><span class="n">jcount</span><span class="p">])</span>
            <span class="n">jcount</span> <span class="o">=</span> <span class="n">jcount</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="n">jcount</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">slice_dim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">islice</span> <span class="ow">in</span> <span class="n">slice_index</span><span class="p">:</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">data_2d</span><span class="p">[</span><span class="n">islice</span><span class="p">,:]</span>
            <span class="k">if</span> <span class="n">r_scale</span><span class="p">:</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">r2_coords</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="n">jcount</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="n">label</span><span class="p">[</span><span class="n">jcount</span><span class="p">])</span>
            <span class="n">jcount</span> <span class="o">=</span> <span class="n">jcount</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="c1">#Set ymin and ymax</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>  <span class="c1"># Change &#39;14&#39; to the desired size</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">ax</span></div>


<div class="viewcode-block" id="plot_stack">
<a class="viewcode-back" href="../../modules/pviz.html#pysunrunner.pviz.plot_stack">[docs]</a>
<span class="k">def</span> <span class="nf">plot_stack</span><span class="p">(</span><span class="n">pluto_list</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">var_name</span> <span class="o">=</span> <span class="s1">&#39;vx1&#39;</span><span class="p">,</span> <span class="n">r_val</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">t_val</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">p_val</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">stack_dim</span> <span class="o">=</span> <span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">cmap</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
    <span class="n">xlabel</span> <span class="o">=</span> <span class="s1">&#39;Time [hours]&#39;</span><span class="p">,</span> <span class="n">ylabel</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">log_scale</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">yshift</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function For a 1-D stack plot</span>

<span class="sd">    **Inputs**:</span>

<span class="sd">    pluto_list: A list with each item a PLUTO 3D array of data values</span>

<span class="sd">    var_name: variable name for plotting</span>

<span class="sd">    r_val: distance (in AU) for cut</span>

<span class="sd">    t_val: latitude (in radians) for cut</span>

<span class="sd">    p_val: longitude (in radians) for </span>

<span class="sd">    stack_dim: dimension for the stack plot (r, t, or p)</span>

<span class="sd">    time: time array (units are hours)</span>

<span class="sd">    cmap: colormap name</span>

<span class="sd">    title: plot title</span>

<span class="sd">    xlabel: x-axis label</span>

<span class="sd">    ylabel: y-axis label</span>

<span class="sd">    r_scale (logical): if True scaled data is plotted (x R^2)</span>

<span class="sd">    log_scale (logical): if True log10 of data is plotted</span>


<span class="sd">    **Outputs**:</span>
<span class="sd">    ax: A plot with one or more slices</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>


    <span class="k">if</span> <span class="n">yshift</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">yshift</span> <span class="o">=</span> <span class="mf">0.0</span>

    <span class="k">if</span> <span class="n">xlabel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">xlabel</span> <span class="o">=</span> <span class="s1">&#39;x-axis&#39;</span>
    <span class="k">if</span> <span class="n">ylabel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ylabel</span> <span class="o">=</span> <span class="s1">&#39;y-axis&#39;</span>

    <span class="c1"># retrieve the first element in the list so we can retrieve the coordinates</span>
    <span class="n">D</span> <span class="o">=</span> <span class="n">pluto_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>


    <span class="c1"># the coordinates are D.x1 D.x2 and D.x3 (r, theta, phi)</span>
    <span class="n">r_coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">x1</span><span class="p">)</span>
    <span class="n">t_coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">x2</span><span class="p">)</span>
    <span class="n">p_coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">x3</span><span class="p">)</span>
    <span class="c1"># convert t_coords wfrom co-latitude to latitude</span>

    <span class="n">t_coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">t_coords</span>

    <span class="c1"># Number of time steps/elemts in the pluto_list</span>

    <span class="n">ntimes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pluto_list</span><span class="p">)</span>

    <span class="c1"># find the r_index for the plot</span>
    <span class="k">if</span> <span class="n">stack_dim</span> <span class="o">!=</span> <span class="s1">&#39;r&#39;</span><span class="p">:</span>
        <span class="n">r_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">r_coords</span><span class="o">-</span> <span class="n">r_val</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">n_slice</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">r_val</span><span class="p">)</span>
        <span class="n">r_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_slice</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_slice</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">icount</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">r_slice</span> <span class="ow">in</span> <span class="n">r_val</span><span class="p">:</span>
            <span class="n">r_idx</span><span class="p">[</span><span class="n">icount</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">r_coords</span> <span class="o">-</span> <span class="n">r_slice</span><span class="p">))</span>
            <span class="n">labels</span><span class="p">[</span><span class="n">icount</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">p_coords</span><span class="p">[</span><span class="n">p_idx</span><span class="p">[</span><span class="n">icount</span><span class="p">]])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
            <span class="n">icount</span> <span class="o">=</span> <span class="n">icount</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="c1"># repeat for t_index</span>
    <span class="k">if</span> <span class="n">stack_dim</span> <span class="o">!=</span> <span class="s1">&#39;t&#39;</span><span class="p">:</span>
        <span class="n">t_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">t_coords</span> <span class="o">-</span> <span class="n">t_val</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">n_slice</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t_val</span><span class="p">)</span>
        <span class="n">t_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_slice</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_slice</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">icount</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">th_slice</span> <span class="ow">in</span> <span class="n">t_val</span><span class="p">:</span>
            <span class="n">t_idx</span><span class="p">[</span><span class="n">icount</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">t_coords</span> <span class="o">-</span> <span class="n">th_slice</span><span class="p">))</span>
            <span class="n">labels</span><span class="p">[</span><span class="n">icount</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">rad2deg</span><span class="p">(</span><span class="n">t_coords</span><span class="p">[</span><span class="n">t_idx</span><span class="p">[</span><span class="n">icount</span><span class="p">]]))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
            <span class="n">icount</span> <span class="o">=</span> <span class="n">icount</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="c1"># and for p_index:</span>
    <span class="k">if</span> <span class="n">stack_dim</span> <span class="o">!=</span> <span class="s1">&#39;p&#39;</span><span class="p">:</span>
        <span class="n">p_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">p_coords</span> <span class="o">-</span> <span class="n">p_val</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span> 
        <span class="n">n_slice</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">p_val</span><span class="p">)</span>
        <span class="n">p_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_slice</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_slice</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">icount</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">fi_slice</span> <span class="ow">in</span> <span class="n">p_val</span><span class="p">:</span>
            <span class="n">p_idx</span><span class="p">[</span><span class="n">icount</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">p_coords</span> <span class="o">-</span> <span class="n">fi_slice</span><span class="p">))</span>
            <span class="n">labels</span><span class="p">[</span><span class="n">icount</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">rad2deg</span><span class="p">(</span><span class="n">p_coords</span><span class="p">[</span><span class="n">p_idx</span><span class="p">[</span><span class="n">icount</span><span class="p">]]))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
            <span class="n">icount</span> <span class="o">=</span> <span class="n">icount</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="n">array_2d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_slice</span><span class="p">,</span> <span class="n">ntimes</span><span class="p">))</span>
    
    <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ntimes</span><span class="p">):</span>
        <span class="n">D</span> <span class="o">=</span> <span class="n">pluto_list</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span>
        <span class="n">data</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">var_name</span><span class="p">)</span>
        <span class="n">array_2d</span><span class="p">[:,</span><span class="n">ii</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">r_idx</span><span class="p">,</span> <span class="n">t_idx</span><span class="p">,</span><span class="n">p_idx</span><span class="p">]</span>
        
    <span class="k">if</span> <span class="n">log_scale</span><span class="p">:</span>
        <span class="n">array_2d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">array_2d</span><span class="p">)</span>

    <span class="c1"># remove all time elements prior to the CME launch</span>
    
    <span class="n">time</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">time</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">]</span>

    <span class="c1">#cmap = plt.colormaps[cmap]</span>
    <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;rainbow&#39;</span><span class="p">)</span>
    <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n_slice</span><span class="p">)</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="n">cmap</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span>

    <span class="c1"># location for vertical line</span>

    <span class="n">x_value</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="n">y1</span> <span class="o">=</span> <span class="mi">2000</span>
    <span class="n">y2</span> <span class="o">=</span> <span class="n">y1</span> <span class="o">*</span> <span class="mi">2</span>

    <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_slice</span><span class="p">):</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="n">array_2d</span><span class="p">[</span><span class="n">ii</span><span class="p">,:]</span> <span class="o">+</span> <span class="n">yshift</span> <span class="o">*</span> <span class="n">ii</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">tmp</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span> 
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">time</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">time</span><span class="p">))</span> <span class="c1"># limit xrange to be 0-40 hours</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([])</span> <span class="c1"># remove y-ticks labels for stack plot</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x_value</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="n">y1</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="n">y2</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>  <span class="c1"># Change &#39;14&#39; to the desired size</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center left&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
    <span class="c1"># plt.legend()</span>

    <span class="k">return</span> <span class="n">ax</span></div>



</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Predictive Science Inc..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>